import{f as m,r as V,a as B}from"./utils-500f8f40.js";import{d as F,r as f,u as j,w as q,f as E,o as r,c,b as o,g as M,h as N,i as d,F as P,t as h,n as $,j as y,k,l as w,M as D,m as z,B as _,q as x,s as L,v as O,p as T,a as A,x as G,_ as H}from"./index-2ef4555b.js";const b=u=>(T("data-v-2559f1b8"),u=u(),A(),u),J={class:"container"},K={class:"datepicker-container"},Q=b(()=>o("label",{for:"datepicker"},"Select Date:",-1)),R=["value"],W={key:0,class:"image-wrapper"},X=["src","alt"],Y=b(()=>o("i",{class:"cs-heart"},null,-1)),Z=[Y],U={key:1},ee=F({__name:"DailyPic",setup(u){const a=f(null),l=f(""),n=f(!1),i=j(),I=async(t=l.value)=>{a.value=null;try{const e=await B.get(`https://api.nasa.gov/planetary/apod?api_key=${window.nasa_api_key}&date=${t}`);if(a.value=e.data,i.state.user){const s=D(k(w,"favoriteImages"),_("uuid","==",i.state.user.uid),_("image","==",a.value.url)),p=await x(s);n.value=!p.empty,console.log(n.value)}}catch(e){console.error(e),a.value=null}},C=async(t,e)=>{const s=k(w,"favoriteImages"),p=D(s,_("uuid","==",e),_("image","==",t),z(1)),g=await x(p);if(g.empty){const v={uuid:e,image:t,created_at:G()};try{await L(s,v),n.value=!0}catch(S){console.error("Error adding favorite image:",S)}}else await O(g.docs[0].ref).then(()=>{console.log("Document successfully deleted!"),n.value=!1}).catch(v=>{console.error("Error deleting document:",v)})};return q(l,t=>{const e=m(t);l.value=e,I()}),E(()=>{const t=m(new Date);l.value=t}),(t,e)=>(r(),c("div",J,[o("div",K,[Q,M(d(V),{format:d(m),modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value=s),"max-date":new Date},{"dp-input":N(({value:s})=>[o("input",{type:"text",value:s},null,8,R)]),_:1},8,["format","modelValue","max-date"])]),a.value?(r(),c(P,{key:0},[o("h1",null,h(a.value.title),1),o("p",null,h(a.value.explanation),1),a.value.url?(r(),c("div",W,[o("img",{src:a.value.url,alt:a.value.title},null,8,X),d(i).state.user?(r(),c("button",{key:0,onClick:e[1]||(e[1]=s=>C(a.value.url,d(i).state.user.uid)),class:$({liked:n.value})},Z,2)):y("",!0)])):y("",!0)],64)):(r(),c("p",U,"Loading..."))]))}});const se=H(ee,[["__scopeId","data-v-2559f1b8"]]);export{se as default};
